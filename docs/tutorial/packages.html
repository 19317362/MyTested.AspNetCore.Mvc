<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Packages </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Packages ">
    <meta name="generator" content="docfx 2.5.0.0">
    {% seo %}
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                MY TESTED ASP.NET CORE MVC DOCS
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="packages" sourcefile="tutorial/packages.md" sourcestartlinenumber="1" sourceendlinenumber="1">Packages</h1>
              
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="3" sourceendlinenumber="3">In this section we will learn the most important parts of arranging and asserting our web application components.</p>
<h2 id="the-building-blocks-of-the-testing-framework" sourcefile="tutorial/packages.md" sourcestartlinenumber="5" sourceendlinenumber="5">The building blocks of the testing framework</h2>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="7" sourceendlinenumber="7">Of course, as a main building block of the ASP.NET Core MVC framework, we will start with controllers. Before we begin, let&#39;s make a step backwards. Remember the <strong>&quot;project.json&quot;</strong> and the referenced <strong>&quot;MyTested.AspNetCore.Mvc&quot;</strong> dependency? Good! The My Tested ASP.NET Core MVC framework consists of many packages. Here are the most important ones:</p>
<ul sourcefile="tutorial/packages.md" sourcestartlinenumber="9" sourceendlinenumber="12">
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="9" sourceendlinenumber="9"><strong>&quot;MyTested.AspNetCore.Mvc.Core&quot;</strong> - Contains setup and assertion methods for MVC core features - controllers, models and routes</li>
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="10" sourceendlinenumber="10"><strong>&quot;MyTested.AspNetCore.Mvc.DataAnnotations&quot;</strong> - Contains setup and assertion methods for data annotation validations and model state</li>
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="11" sourceendlinenumber="11"><strong>&quot;MyTested.AspNetCore.Mvc.ViewFeatures&quot;</strong> - Contains setup and assertion methods for view action results, view data, view components and more</li>
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="12" sourceendlinenumber="12"><strong>&quot;MyTested.AspNetCore.Mvc&quot;</strong> - Contains assertion methods for the full MVC framework </li>
</ul>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="14" sourceendlinenumber="14">The packages above reflect the features in the ASP.NET Core packages - &quot;<strong>Microsoft.AspNetCore.Mvc.Core&quot;</strong>, &quot;<strong>Microsoft.AspNetCore.Mvc.DataAnnotations&quot;</strong>, &quot;<strong>Microsoft.AspNetCore.Mvc.ViewFeatures&quot;</strong> and &quot;<strong>Microsoft.AspNetCore.Mvc&quot;</strong>.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="16" sourceendlinenumber="16">These so called &quot;main&quot; packages can be separated further to <strong>&quot;MyTested.AspNetCore.Mvc.Controllers&quot;</strong>, <strong>&quot;MyTested.AspNetCore.Mvc.Routing&quot;</strong>, <strong>&quot;MyTested.AspNetCore.Mvc.ViewActionResults&quot;</strong>, <strong>&quot;MyTested.AspNetCore.Mvc.ViewComponents&quot;</strong> and more. Helper packages for testing non-MVC related features like <strong>&quot;MyTested.AspNetCore.Mvc.EntityFrameworkCore&quot;</strong> and <strong>&quot;MyTested.AspNetCore.Mvc.Authentication&quot;</strong> are also available.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="18" sourceendlinenumber="18">Additionally, these two packages are also available:</p>
<ul sourcefile="tutorial/packages.md" sourcestartlinenumber="20" sourceendlinenumber="21">
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="20" sourceendlinenumber="20"><strong>&quot;MyTested.AspNetCore.Mvc.Universe&quot;</strong> - Combines all available binaries and the whole fluent API into one single package. Use it, if you do not want to include specific smaller packages and want to have every feature available.</li>
<li sourcefile="tutorial/packages.md" sourcestartlinenumber="21" sourceendlinenumber="21"><strong>&quot;MyTested.AspNetCore.Mvc.Lite&quot;</strong> - Completely <strong>FREE</strong> and <strong>UNLIMITED</strong> version of the library. It should not be used in combination with any other package. Includes &quot;&quot;<em>Controllers&quot;</em><em>, `ViewActionResults&quot;</em>* and `ViewComponents&quot;**.</li>
</ul>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="23" sourceendlinenumber="23">Full list and descriptions of all available packages can be found <a href="/guide/packages.html" sourcefile="tutorial/packages.md" sourcestartlinenumber="23" sourceendlinenumber="23">HERE</a>. All of them except the <strong>&quot;Lite&quot;</strong> one require a license code in order to be used without limitations. If a license code is not provided, a maximum of 100 assertions per test project is allowed. More information about the licensing can be found <a href="/guide/licensing.html" sourcefile="tutorial/packages.md" sourcestartlinenumber="23" sourceendlinenumber="23">HERE</a>.</p>
<h2 id="breaking-down-the-mvc-package" sourcefile="tutorial/packages.md" sourcestartlinenumber="25" sourceendlinenumber="25">Breaking down the MVC package</h2>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="27" sourceendlinenumber="27">Now, let&#39;s get back to the testing. Go to the <strong>&quot;project.json&quot;</strong> file and replace the <strong>&quot;MyTested.AspNetCore.Mvc&quot;</strong> dependency with <strong>&quot;MyTested.AspNetCore.Mvc.Controllers&quot;</strong>. We will start using the small and specific packages for now and then we will switch to the <strong>&quot;Universe&quot;</strong> one later in the tutorial.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="29" sourceendlinenumber="29">Your <strong>&quot;project.json&quot;</strong> dependencies should look like this:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="31" sourceendlinenumber="38"><code class="lang-json">&quot;dependencies&quot;: {
  &quot;dotnet-test-xunit&quot;: &quot;2.2.0-*&quot;,
  &quot;xunit&quot;: &quot;2.2.0-*&quot;,
  &quot;MyTested.AspNetCore.Mvc.Controllers&quot;: &quot;1.0.0&quot;,
  &quot;MusicStore&quot;: &quot;*&quot;
},
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="40" sourceendlinenumber="40">If you try to build the solution, you will receive an error stating that <strong>&quot;MyMvc&quot;</strong> does not exist.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="42" sourceendlinenumber="42"><img src="/images/tutorial/mymvcdoesnotexist.jpg" alt="MyMvc no longer exists"></p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="44" sourceendlinenumber="44">The <strong>&quot;MyMvc&quot;</strong> class is only available in the <strong>&quot;MyTested.AspNetCore.Mvc&quot;</strong> package and combines all the different test types into a single starting point. To fix our test, we have to use the <strong>&quot;MyController&quot;</strong> class:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="46" sourceendlinenumber="54"><code class="lang-c#">[Fact]
public void AddressAndPaymentShouldReturnDefaultView()
    =&gt; MyController&lt;CheckoutController&gt;
        .Instance()
        .Calling(c =&gt; c.AddressAndPayment())
        .ShouldReturn()
        .View();
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="56" sourceendlinenumber="56">Unfortunately, it still does not compile because the <strong>&quot;Controllers&quot;</strong> package contains assertions methods for the <a href="https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/ControllerBase.cs" sourcefile="tutorial/packages.md" sourcestartlinenumber="56" sourceendlinenumber="56">ControllerBase</a> class which does not include view features and action results.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="58" sourceendlinenumber="58">You can see this by examining the intellisense of the test result:</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="60" sourceendlinenumber="60"><img src="/images/tutorial/coreintellisense.jpg" alt="Controllers package intellisense"></p>
<h2 id="asserting-core-controllers" sourcefile="tutorial/packages.md" sourcestartlinenumber="62" sourceendlinenumber="62">Asserting core controllers</h2>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="64" sourceendlinenumber="64">We will now try the core action results before returning back to the view features. Comment the first test for now (so that the project will compile with the currently added dependencies) and add a new class named <strong>&quot;ManageControllerTest&quot;</strong> in the <strong>&quot;Controllers&quot;</strong> folder. We will test the asynchronous <strong>&quot;RemoveLogin&quot;</strong> action in the <strong>&quot;ManageController&quot;</strong>. If you examine it, you will notice that it returns <strong>&quot;RedirectToAction&quot;</strong>, if no user is authenticated.</p>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="66" sourceendlinenumber="66">Add the necessary usings and write the following test into the <strong>&quot;ManageControllerTest&quot;</strong> class:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="68" sourceendlinenumber="76"><code class="lang-c#">[Fact]
public void RemoveLoginShouldReturnRedirectToActionWithNoUser()
    =&gt; MyController&lt;ManageController&gt;
        .Instance()
        .Calling(c =&gt; c.RemoveLogin(null, null))
        .ShouldReturn()
        .Redirect();
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="78" sourceendlinenumber="78">Run the test and it should pass correctly. As you can see My Tested ASP.NET Core MVC tests asynchronous actions flawlessly. If you do not like the null values, you may use the built-in helper class <strong>&quot;With&quot;</strong> to specify that there are no action arguments in this test:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="80" sourceendlinenumber="82"><code class="lang-c#">.Calling(c =&gt; c.RemoveLogin(With.No&lt;string&gt;(), With.No&lt;string&gt;()))
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="84" sourceendlinenumber="84">As a bonus, let&#39;s assert some details of the redirect action result. We can see it redirects to the <strong>&quot;ManageLogins&quot;</strong> action with some <strong>&quot;ManageMessageId&quot;</strong> route value so we better test them:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="86" sourceendlinenumber="98"><code class="lang-c#">[Fact]
public void RemoveLoginShouldReturnRedirectToActionWithNoUser()
    =&gt; MyController&lt;ManageController&gt;
        .Instance()
        .Calling(c =&gt; c.RemoveLogin(
            With.No&lt;string&gt;(),
            With.No&lt;string&gt;()))
        .ShouldReturn()
        .Redirect()
        .ToAction(nameof(ManageController.ManageLogins))
        .ContainingRouteValues(new { Message = ManageController.ManageMessageId.Error });
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="100" sourceendlinenumber="100">Now we can sleep peacefully! :)</p>
<h2 id="adding-view-action-results" sourcefile="tutorial/packages.md" sourcestartlinenumber="102" sourceendlinenumber="102">Adding view action results</h2>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="104" sourceendlinenumber="104">OK, back to that commented test. We cannot test views with our current dependencies. Go to the <strong>&quot;project.json&quot;</strong> and add <strong>&quot;MyTested.AspNetCore.Mvc.ViewActionResults&quot;</strong> as a dependency:</p>
<pre sourcefile="tutorial/packages.md" sourcestartlinenumber="106" sourceendlinenumber="114"><code class="lang-json">&quot;dependencies&quot;: {
  &quot;dotnet-test-xunit&quot;: &quot;2.2.0-*&quot;,
  &quot;xunit&quot;: &quot;2.2.0-*&quot;,
  &quot;MyTested.AspNetCore.Mvc.Controllers&quot;: &quot;1.0.0&quot;,
  &quot;MyTested.AspNetCore.Mvc.ViewActionResults&quot;: &quot;1.0.0&quot;, // &lt;---
  &quot;MusicStore&quot;: &quot;*&quot;
},
</code></pre><p sourcefile="tutorial/packages.md" sourcestartlinenumber="116" sourceendlinenumber="116">This package adds all action results from the <a href="https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.ViewFeatures/Controller.cs" sourcefile="tutorial/packages.md" sourcestartlinenumber="116" sourceendlinenumber="116">Controller</a> class from the <a href="https://github.com/aspnet/Mvc/tree/dev/src/Microsoft.AspNetCore.Mvc.ViewFeatures" sourcefile="tutorial/packages.md" sourcestartlinenumber="116" sourceendlinenumber="116">ViewFeatures</a> MVC package. Go back to the <strong>&quot;CheckoutControllerTest&quot;</strong> class and uncomment the view test. It should compile and pass successfully now.</p>
<h2 id="section-summary" sourcefile="tutorial/packages.md" sourcestartlinenumber="118" sourceendlinenumber="118">Section summary</h2>
<p sourcefile="tutorial/packages.md" sourcestartlinenumber="120" sourceendlinenumber="120">In this section we learned how we can use only these parts from My Tested ASP.NET Core MVC that we actually need in our testing project. As you can see each small package dependency adds additional extension methods to the fluent API. We will add more and more packages in the next sections so that you can get familiar with them. Next - <a href="/tutorial/debugging.html" sourcefile="tutorial/packages.md" sourcestartlinenumber="120" sourceendlinenumber="120">Debugging Failed Tests</a>!</p>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ivaylokenov/MyTested.AspNetCore.Mvc/blob/tutorial/docs/_docfx/tutorial/packages.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright © 2015-2016 <strong><a href="http://mytestedasp.net">MyTestedASP.NET</a></strong>. All Rights Reserved. Generated by <strong><a href="http://dotnet.github.io/docfx/">DocFX</a></strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
